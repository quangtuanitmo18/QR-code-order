//// ------------------------------------------------------
//// THIS FILE WAS AUTOMATICALLY GENERATED (DO NOT MODIFY)
//// ------------------------------------------------------

Table Account {
  id Int [pk, increment]
  name String [not null]
  email String [unique, not null]
  password String [not null]
  avatar String
  role String [not null, default: 'Employee']
  ownerId Int
  createdAt DateTime [default: `now()`, not null]
  updatedAt DateTime [not null]
  owner Account
  employees Account [not null]
  orders Order [not null]
  payments Payment [not null]
  refreshToken RefreshToken [not null]
  sockets Socket
  approvedReviews Review [not null]
  repliedReviews Review [not null]
  blogPosts BlogPost [not null]
  createdEvents CalendarEvent [not null]
  eventAssignments CalendarEventAssignment [not null]
  notifications CalendarNotification [not null]
  createdCalendarTypes CalendarType [not null]
  coupons Coupon [not null]
  employeeSpins EmployeeSpin [not null]
  adminCreatedSpins EmployeeSpin [not null]
  createdSpinEvents SpinEvent [not null]
}

Table Dish {
  id Int [pk, increment]
  name String [not null]
  price Int [not null]
  description String [not null]
  image String [not null]
  status String [not null, default: 'Available']
  createdAt DateTime [default: `now()`, not null]
  updatedAt DateTime [not null]
  dishSnapshots DishSnapshot [not null]
}

Table DishSnapshot {
  id Int [pk, increment]
  name String [not null]
  price Int [not null]
  description String [not null]
  image String [not null]
  status String [not null, default: 'Available']
  dishId Int
  updatedAt DateTime [not null]
  createdAt DateTime [default: `now()`, not null]
  dish Dish
  orderItems OrderItem [not null]
}

Table Table {
  number Int [pk, increment]
  capacity Int [not null]
  status String [not null, default: 'Available']
  token String [not null]
  createdAt DateTime [default: `now()`, not null]
  updatedAt DateTime [not null]
  guests Guest [not null]
  orders Order [not null]
}

Table Order {
  id Int [pk, increment]
  guestId Int
  tableNumber Int
  totalAmount Int [not null, default: 0]
  orderHandlerId Int
  status String [not null, default: 'Pending']
  paymentId Int
  couponId Int
  discountAmount Int [default: 0]
  createdAt DateTime [default: `now()`, not null]
  updatedAt DateTime [not null]
  payment Payment
  orderHandler Account
  table Table
  guest Guest
  coupon Coupon
  items OrderItem [not null]
  couponUsages CouponUsage [not null]
}

Table OrderItem {
  id Int [pk, increment]
  orderId Int [not null]
  dishSnapshotId Int [not null]
  quantity Int [not null]
  unitPrice Int [not null]
  totalPrice Int [not null]
  createdAt DateTime [default: `now()`, not null]
  updatedAt DateTime [not null]
  order Order [not null]
  dishSnapshot DishSnapshot [not null]
}

Table RefreshToken {
  token String [pk]
  accountId Int [not null]
  expiresAt DateTime [not null]
  createdAt DateTime [default: `now()`, not null]
  account Account [not null]
}

Table Guest {
  id Int [pk, increment]
  name String [not null]
  tableNumber Int
  refreshToken String
  refreshTokenExpiresAt DateTime
  createdAt DateTime [default: `now()`, not null]
  updatedAt DateTime [not null]
  table Table
  orders Order [not null]
  payments Payment [not null]
  sockets Socket
  reviews Review [not null]
  couponUsages CouponUsage [not null]
}

Table Payment {
  id Int [pk, increment]
  guestId Int
  tableNumber Int
  amount Int [not null]
  paymentMethod String [not null]
  status String [not null, default: 'Pending']
  transactionRef String [unique, not null]
  externalTransactionId String
  externalCustomerId String
  externalSessionId String
  paymentUrl String
  returnUrl String
  ipAddress String
  responseCode String
  responseMessage String
  bankCode String
  cardType String
  paymentIntentStatus String
  last4Digits String
  cardBrand String
  currency String [default: 'VND']
  metadata String
  description String
  note String
  paymentHandlerId Int
  couponId Int
  discountAmount Int [default: 0]
  createdAt DateTime [default: `now()`, not null]
  updatedAt DateTime [not null]
  paidAt DateTime
  orders Order [not null]
  paymentHandler Account
  guest Guest
  coupon Coupon
  couponUsages CouponUsage [not null]
}

Table Socket {
  socketId String [pk]
  accountId Int [unique]
  guestId Int [unique]
  guest Guest
  account Account
}

Table Coupon {
  id Int [pk, increment]
  code String [unique, not null]
  discountType String [not null]
  discountValue Int [not null]
  minOrderAmount Int
  applicableDishIds String
  maxTotalUsage Int
  maxUsagePerGuest Int
  usageCount Int [not null, default: 0]
  startDate DateTime [not null]
  endDate DateTime [not null]
  status String [not null, default: 'ACTIVE']
  createdById Int [not null]
  createdAt DateTime [default: `now()`, not null]
  updatedAt DateTime [not null]
  createdBy Account [not null]
  usages CouponUsage [not null]
  orders Order [not null]
  payments Payment [not null]
}

Table CouponUsage {
  id Int [pk, increment]
  couponId Int [not null]
  guestId Int
  orderId Int
  paymentId Int
  discountAmount Int [not null]
  usedAt DateTime [default: `now()`, not null]
  coupon Coupon [not null]
  guest Guest
  order Order
  payment Payment
}

Table Review {
  id Int [pk, increment]
  guestId Int [not null]
  overallRating Int [not null]
  foodQuality Int [not null]
  serviceQuality Int [not null]
  ambiance Int [not null]
  priceValue Int [not null]
  comment String [not null]
  images String
  status String [not null, default: 'HIDDEN']
  ipAddress String
  userAgent String
  createdAt DateTime [default: `now()`, not null]
  updatedAt DateTime [not null]
  approvedAt DateTime
  approvedBy Int
  replyContent String
  repliedAt DateTime
  repliedBy Int
  guest Guest [not null]
  approver Account
  replier Account
}

Table BlogPost {
  id Int [pk, increment]
  title String [not null]
  slug String [unique, not null]
  excerpt String
  content String [not null]
  featuredImage String
  status String [not null, default: 'DRAFT']
  featured Boolean [not null, default: false]
  viewCount Int [not null, default: 0]
  category String
  tags String
  authorId Int [not null]
  publishedAt DateTime
  createdAt DateTime [default: `now()`, not null]
  updatedAt DateTime [not null]
  author Account [not null]
}

Table CalendarType {
  id Int [pk, increment]
  name String [unique, not null]
  label String [not null]
  color String [not null, default: 'bg-blue-500']
  category String [not null, default: 'personal']
  visible Boolean [not null, default: true]
  createdById Int [not null]
  createdAt DateTime [default: `now()`, not null]
  updatedAt DateTime [not null]
  createdBy Account [not null]
  events CalendarEvent [not null]
}

Table CalendarEvent {
  id Int [pk, increment]
  title String [not null]
  description String
  typeId Int [not null]
  startDate DateTime [not null]
  endDate DateTime [not null]
  allDay Boolean [not null, default: false]
  location String
  color String
  isRecurring Boolean [not null, default: false]
  recurringRule String
  createdById Int [not null]
  createdAt DateTime [default: `now()`, not null]
  updatedAt DateTime [not null]
  type CalendarType [not null]
  createdBy Account [not null]
  assignments CalendarEventAssignment [not null]
  notifications CalendarNotification [not null]
}

Table CalendarEventAssignment {
  id Int [pk, increment]
  eventId Int [not null]
  employeeId Int [not null]
  createdAt DateTime [default: `now()`, not null]
  event CalendarEvent [not null]
  employee Account [not null]

  indexes {
    (eventId, employeeId) [unique]
  }
}

Table CalendarNotification {
  id Int [pk, increment]
  eventId Int [not null]
  userId Int [not null]
  notificationType String [not null]
  message String [not null]
  scheduledFor DateTime [not null]
  isRead Boolean [not null, default: false]
  readAt DateTime
  createdAt DateTime [default: `now()`, not null]
  event CalendarEvent [not null]
  user Account [not null]
}

Table SpinEvent {
  id Int [pk, increment]
  name String [not null]
  description String
  startDate DateTime [not null]
  endDate DateTime
  isActive Boolean [not null, default: true]
  createdById Int [not null]
  createdBy Account [not null]
  rewards SpinReward [not null]
  spins EmployeeSpin [not null]
  createdAt DateTime [default: `now()`, not null]
  updatedAt DateTime [not null]
}

Table SpinReward {
  id Int [pk, increment]
  name String [not null]
  description String
  type String [not null]
  value String
  probability Float [not null]
  color String [not null, default: 'bg-blue-500']
  icon String
  isActive Boolean [not null, default: true]
  order Int [not null, default: 0]
  maxQuantity Int
  currentQuantity Int [not null, default: 0]
  version Int [not null, default: 0]
  eventId Int [not null]
  createdAt DateTime [default: `now()`, not null]
  updatedAt DateTime [not null]
  event SpinEvent [not null]
  spins EmployeeSpin [not null]
}

Table EmployeeSpin {
  id Int [pk, increment]
  employeeId Int [not null]
  rewardId Int [not null]
  eventId Int
  status String [not null, default: 'PENDING']
  claimedAt DateTime
  expiredAt DateTime
  spinDate DateTime [default: `now()`, not null]
  notes String
  createdById Int
  employee Account [not null]
  reward SpinReward [not null]
  event SpinEvent
  createdBy Account
}

Ref: Account.ownerId - Account.id

Ref: DishSnapshot.dishId > Dish.id

Ref: Order.paymentId > Payment.id

Ref: Order.orderHandlerId > Account.id

Ref: Order.tableNumber > Table.number

Ref: Order.guestId > Guest.id

Ref: Order.couponId > Coupon.id

Ref: OrderItem.orderId > Order.id [delete: Cascade]

Ref: OrderItem.dishSnapshotId > DishSnapshot.id

Ref: RefreshToken.accountId > Account.id [delete: Cascade]

Ref: Guest.tableNumber > Table.number

Ref: Payment.paymentHandlerId > Account.id

Ref: Payment.guestId > Guest.id

Ref: Payment.couponId > Coupon.id

Ref: Socket.guestId - Guest.id

Ref: Socket.accountId - Account.id

Ref: Coupon.createdById > Account.id

Ref: CouponUsage.couponId > Coupon.id [delete: Cascade]

Ref: CouponUsage.guestId > Guest.id

Ref: CouponUsage.orderId > Order.id

Ref: CouponUsage.paymentId > Payment.id

Ref: Review.guestId > Guest.id

Ref: Review.approvedBy > Account.id

Ref: Review.repliedBy > Account.id

Ref: BlogPost.authorId > Account.id

Ref: CalendarType.createdById > Account.id

Ref: CalendarEvent.typeId > CalendarType.id

Ref: CalendarEvent.createdById > Account.id

Ref: CalendarEventAssignment.eventId > CalendarEvent.id [delete: Cascade]

Ref: CalendarEventAssignment.employeeId > Account.id [delete: Cascade]

Ref: CalendarNotification.eventId > CalendarEvent.id [delete: Cascade]

Ref: CalendarNotification.userId > Account.id [delete: Cascade]

Ref: SpinEvent.createdById > Account.id

Ref: SpinReward.eventId > SpinEvent.id [delete: Cascade]

Ref: EmployeeSpin.employeeId > Account.id [delete: Cascade]

Ref: EmployeeSpin.rewardId > SpinReward.id

Ref: EmployeeSpin.eventId > SpinEvent.id

Ref: EmployeeSpin.createdById > Account.id [delete: Cascade]